var e=Object.defineProperty,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;import{_ as r}from"./AlertModal-a9166c28.js";import{_ as n}from"./FormInputText-27d1615b.js";import{c as l,a as i,b as m}from"./object-9b840b78.js";import{_ as u,T as c,U as d}from"./index-d8506044.js";import{m as p,r as w,o as f,c as b,a as g,d as h,t as v,e as y,w as S,s as x,u as I,E,aw as B}from"./vendor-385d4c3c.js";const O={name:"UserInfo",components:{FormInputText:n,AlertModal:r},emits:["get-info"],data:()=>({passwordSchema:l().shape({"user-current-password":i().min(6).required(),"user-new-password":i().min(6).required(),"user-confirm-new-password":i().required().oneOf([m("user-new-password"),null],"密碼需一致 !")}),emailSchema:l().shape({"user-new-email":i().email().required()}),alertInfo:null,isShowEmailInput:!1}),computed:((e,r)=>{for(var n in r||(r={}))a.call(r,n)&&o(e,n,r[n]);if(s)for(var n of s(r))t.call(r,n)&&o(e,n,r[n]);return e})({},p(["userInfo"])),methods:{onPasswordSubmit(e){const s={Username:this.userInfo.Username,O_Password:e["user-current-password"],N_Password:e["user-new-password"]};c(s).then((e=>{e.data.success?(this.alertInfo={message:"密碼修改成功，請重新登入!",confirmMode:"replace",confirmTodo:{name:"SignIn"},messageClass:"text-lg font-bold text-myBrown md:text-xl",showCancel:!1},this.signOut(),this.$store.commit("SHOW_ALERT")):this.$notify({group:"error",title:e.data.message})})).catch((e=>{}))},onPasswordInvalidSubmit(e){},toggleChangeEmail(){this.isShowEmailInput=!this.isShowEmailInput},onEmailSubmit(e){d(e["user-new-email"]).then((e=>{e.data.success?(this.$notify({group:"success",title:"Email 更新成功"}),this.$emit("get-info"),this.toggleChangeEmail()):this.$notify({group:"error",title:e.data.message})})).catch((e=>{}))},onEmailInvalidSubmit(e){},signOut(){localStorage.removeItem("kirukiruToken"),this.$store.commit("SIGN_OUT")},getNewUserInfo(){getUserInfo().then((e=>{e.data.success?this.$store.commit("SET_USER_INFO",e.data.data):(localStorage.removeItem("kirukiruToken"),this.$router.push({name:"SignIn"}))})).catch((e=>{this.$notify({group:"error",title:"Error",text:`${e}`},2500),this.$router.push({name:"HomePage"})}))}}},P={class:"w-full"},$=h("h2",{class:"mb-8 text-2xl font-bold text-myBrown"}," 個人資料 ",-1),_={class:"flex items-center py-4 text-myBrown border-b border-myBrown"},j=h("div",{class:"w-1/4 font-bold"}," 帳號 ",-1),T={class:"py-12 border-b border-myBrown"},U=h("div",{class:"mb-5 w-1/4 font-bold text-myBrown"}," 變更密碼 ",-1),k={class:"flex flex-col gap-6"},C={class:"flex text-myBrown"},q=h("span",{class:"w-1/4"},"目前密碼",-1),N={class:"flex text-myBrown"},Y=h("span",{class:"w-1/4"},"輸入新密碼",-1),A={class:"flex text-myBrown"},F=h("span",{class:"w-1/4"},"再次輸入",-1),M=h("div",{class:"text-center"},[h("button",{type:"submit",class:"userPageButton"}," 確認變更 ")],-1),H={class:"py-12"},R={class:"flex flex-col gap-6"},G={class:"flex items-center text-myBrown"},L=h("div",{class:"w-1/4 font-bold"}," E-mail ",-1),W={class:"flex gap-3 text-myBrown"},z=h("div",{class:"text-center"},[h("button",{type:"submit",class:"userPageButton"}," 確認更改 ")],-1),D={class:"text-center"};var J=u(O,[["render",function(e,s,a,t,o,l){const i=n,m=w("v-form"),u=r;return f(),b("div",P,[$,g(" 帳號 "),h("div",_,[j,h("div",null,[h("span",null,v(e.userInfo.Username),1)])]),g(" 變更密碼 "),h("div",T,[U,h("div",k,[y(m,{"validation-schema":o.passwordSchema,onSubmit:l.onPasswordSubmit,onInvalidSubmit:l.onPasswordInvalidSubmit},{default:S((()=>[g(" 目前密碼 "),h("div",C,[q,y(i,{name:"user-current-password",type:"password",label:"目前密碼",placeholder:"目前密碼",class:"mb-10","success-message":"","input-border":"focus:ring-2 focus:ring-myYellow"})]),g(" 輸入新密碼 "),h("div",N,[Y,y(i,{name:"user-new-password",type:"password",label:"新密碼",placeholder:"新密碼",class:"mb-10","success-message":"","input-border":"focus:ring-2 focus:ring-myYellow"})]),g(" 再次輸入 "),h("div",A,[F,y(i,{name:"user-confirm-new-password",type:"password",label:"再次輸入密碼",placeholder:"再次輸入密碼",class:"mb-10","success-message":"","input-border":"focus:ring-2 focus:ring-myYellow"})]),M])),_:1},8,["validation-schema","onSubmit","onInvalidSubmit"])])]),g(" 變更Email "),h("div",H,[h("div",R,[g(" E-mail "),h("div",G,[L,h("div",null,[h("span",null,v(e.userInfo.Email),1)])]),x(y(m,{"validation-schema":o.emailSchema,onSubmit:l.onEmailSubmit,onInvalidSubmit:l.onEmailInvalidSubmit},{default:S((()=>[g(" 輸入Email "),h("div",W,[y(i,{name:"user-new-email",type:"email",label:"Email",placeholder:"Email",class:"w-full","success-message":"","input-border":"focus:ring-2 focus:ring-myYellow"}),z])])),_:1},8,["validation-schema","onSubmit","onInvalidSubmit"]),[[I,o.isShowEmailInput]]),h("div",D,[h("button",{type:"submit",class:"userPageButton",onClick:s[0]||(s[0]=(...e)=>l.toggleChangeEmail&&l.toggleChangeEmail(...e))}," 更改 E-mail ")])])]),y(u,E(B(o.alertInfo)),null,16)])}]]);export{J as default};
